{% extends 'jobdata/base.html' %}
{% load staticfiles %}

{% block head %}
	<!-- when using the mode "code", it's important to specify charset utf-8 -->
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8">	
	<link href="{% static "jobdata/jsoneditor/dist/jsoneditor.min.css" %}" rel="stylesheet" type="text/css">
	<script src="{% static "jobdata/jsoneditor/dist/jsoneditor.min.js" %}"></script>
	<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
	<script src="{% static "jobdata/script.js" %}"></script>
{% endblock %}

{% block content %}
	<div id="jsoneditor" style="width: 1200px; height: 800px;"></div>

	<button id="my_button">Hello!</button>

	<script>
	// create the editor
	var container = document.getElementById("jsoneditor");

	var options = {
		editable: function (node) {
			//alert(node.path);
			if (typeof node.field === "undefined") {
				return true;
				//alert("field undef");
			} else {
				if (node.field.slice(0,1) === '_') {
					return false;
				}
				//alert("node.field = " + node.field);
			}
			return true;
		}
	};

	var json = {% autoescape off %}{{ json }}{% endautoescape %};

	var editor = new JSONEditor(container, options);

	editor.set(json);

	$("#my_button").click(function() {
		var j = editor.get();
		var s = JSON.stringify(j, null, 2);
		var x = {json: s, csrfmiddlewaretoken: "{{ csrf_token }}"};
		alert(s);
		post("", x);
	});

	</script>

{% endblock %}



